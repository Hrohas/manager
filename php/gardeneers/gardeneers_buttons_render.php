<?php
    $gardeneers_buttons =[
        '
                    <form class="button_main">
                <div class="button_main_left">
                    <div class="button_main_items user_select font__14 ">Ещё</div>
                    <div class="button_main_item_centr">
                        <div class="button_main_items user_select"><i class="fa fa-paperclip" aria-hidden="true"></i> </div>
                        <div class="button_main_items user_select">Групповые обработки<i class="fa fa-arrow-down" aria-hidden="true"></i></div>
                    </div>
                    <div class="button_main_item_right">
                        <div class="button_main_items user_select font__14 "><i class="fa fa-print" aria-hidden="true"></i>Печать<i class="fa fa-arrow-down" aria-hidden="true"></i></div>
                        <div class="button_main_items user_select font__14 "><i class="fa fa-file-text-o" aria-hidden="true"></i>Отчеты<i class="fa fa-arrow-down" aria-hidden="true"></i></div>
                    </div>
                </div>
                <div class="button_main_rigt">
                    <div class="seartch"><input type="user_select" name="">
                        <div class="user_select"><i class="fa fa-times" aria-hidden="true"></i></div>
                    </div>
                    <div class="button_main_items user_select font__14">Ещё</div>
                    <div class="button_main_items user_select font__14">?</div>
                </div>
            </form>
            <div class="gardeneer_catd_action_all">
                <div class="gardeneer_catd_action_grid_header">
                    <div class="gardeneer_catd_action_grid_header_items font__14 user_select">Владелец</div>
                    <div class="gardeneer_catd_action_grid_header_items font__14 user_select">№ Участка</div>
                    <div class="gardeneer_catd_action_grid_header_items font__14 user_select">Общая площадь</div>
                    <div class="gardeneer_catd_action_grid_header_items font__14 user_select">На начало месяца</div>
                    <div class="gardeneer_catd_action_grid_header_items font__14 user_select">Начислено</div>
                    <div class="gardeneer_catd_action_grid_header_items font__14 user_select">Оплачено</div>
                    <div class="gardeneer_catd_action_grid_header_items font__14 user_select">На конец месяца</div>
                </div>
                <div class="gardeneer_action_wrapper"></div>
            </div>
        ',
     '<div class="services">
     <span class="name_servises_itm font__25 ">Услуги и тарифы</span>
     <form class="button_services">
         <div class="button_services_left">
             <div class="button_main_items user_select font__14 ">Создать</div>
                 <div class="button_main_items user_select"><i class="fa fa-file-o" aria-hidden="true"></i>
                 </div>
                 <div class="button_main_items user_select font__14 ">Найти..</div>
                 <button class="button_main_items user_select font__14 " disabled="disabled">Отменить поиск</button>
                 <button class="button_main_items user_select font__14 " disabled="disabled">Изменение цены</button>
         </div>
         <div class="button_main_rigt">
             <div class="button_main_items user_select font__14 ">Ещё</div>
             <div class="button_main_items user_select font__14 ">?</div>
         </div>
         </form>
         <div class="gardeneer_catd_action_all">
         <div class="gardeneer_catd_action_grid_header">
             <div class="gardeneer_catd_action_grid_header_items  user_select">Наименование</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Код</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Цена</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Единица учета</div>
         </div>
         <div class="gardeneer_catd_action_grid_action">
             <div class="gardeneer_catd_action_grid_action_itm  user_select"><i class="fa fa-minus-circle" aria-hidden="true"></i>Холодное водоснобжение</div>
             <div class="gardeneer_catd_action_grid_action_itm  user_select"></div>
             <div class="gardeneer_catd_action_grid_action_itm  user_select"></div>
             <div class="gardeneer_catd_action_grid_action_itm  user_select"></div>
         </div>
         <div class="gardeneer_catd_action_grid_action_sub">
             <div class="gardeneer_catd_action_grid_action_itm sub font__14 user_select">Холодное водоснобжение по показаниям приборов учета</div>
             <div class="gardeneer_catd_action_grid_action_itm font__14 user_select">000002</div>
             <div class="gardeneer_catd_action_grid_action_itm font__14 user_select">20.000</div>
             <div class="gardeneer_catd_action_grid_action_itm font__14 user_select"></div>
         </div>
     </div>
 </div>',
     '<div class="accruals">
     <span class="name_servises_itm font__25 ">Начисления</span>
     <form class="button_services">
         <div class="button_services_left">
             <div class="button_main_items user_select font__14 ">Создать</div>
             <div class="button_main_items user_select"><i class="fa fa-file-o" aria-hidden="true"></i>
             </div>
             <div class="button_main_items user_select font__14 ">Найти..</div>
             <button class="button_main_items user_select font__14 " disabled="disabled">Отменить
                 поиск</button>
             <button class="button_main_items user_select font__14 " disabled="disabled">Изменение
                 цены</button>
             <div class="button_main_items user_select font__14 "><i class="fa fa-sort-alpha-asc"
                     aria-hidden="true"></i></div>
         </div>
         <div class="button_main_rigt">
             <div class="button_main_items user_select font__14 ">Ещё</div>
             <div class="button_main_items user_select font__14 ">?</div>
         </div>
     </form>
     <div class="gardeneer_catd_action_all">
         <div class="gardeneer_catd_action_grid_header">
             <div class="gardeneer_catd_action_grid_header_items  user_select">Дата</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Номер</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Карточка садовода для
                 расчета</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Сумма начисленей</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Ежемесечные начисления
             </div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Комментарий</div>
         </div>
         <div class="gardeneer_catd_action_grid_action">
             <div class="gardeneer_catd_action_grid_action_itm  user_select">01.03.2021 15:40</div>
             <div class="gardeneer_catd_action_grid_action_itm  user_select">00002</div>
             <div class="gardeneer_catd_action_grid_action_itm  user_select"></div>
             <div class="gardeneer_catd_action_grid_action_itm  user_select">4 200</div>
             <div class="gardeneer_catd_action_grid_action_itm  user_select"></div>
             <div class="gardeneer_catd_action_grid_action_itm  user_select">Начальные остатки</div>
         </div>
     </div>
 </div>',
     '<div class="re_culc">
     <span class="name_servises_itm font__25 ">Перерасчёт</span>
     <form class="button_services">
         <div class="button_services_left">
             <div class="button_main_items user_select font__14 ">Создать</div>
             <div class="button_main_items user_select"><i class="fa fa-file-o" aria-hidden="true"></i>
             </div>
             <div class="button_main_items user_select font__14 ">Найти..</div>
             <button class="button_main_items user_select font__14 " disabled="disabled">Отменить
                 поиск</button>
             <button class="button_main_items user_select font__14 " disabled="disabled">Изменение
                 цены</button>
             <div class="button_main_items user_select font__14 "><i class="fa fa-sort-alpha-asc"
                     aria-hidden="true"></i></div>
         </div>
         <div class="button_main_rigt">
             <div class="button_main_items user_select font__14 ">Ещё</div>
             <div class="button_main_items user_select font__14 ">?</div>
         </div>
     </form>
     <div class="gardeneer_catd_action_all">
         <div class="gardeneer_catd_action_grid_header">
             <div class="gardeneer_catd_action_grid_header_items  user_select">Дата</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Номер</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Cумма зачислений</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Ответственный</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Комментарий</div>
         </div>
         <div class="gardeneer_catd_action_grid_action">
         </div>
     </div>
 </div>',
     '<div class="opiration">
     <span class="name_servises_itm font__25 ">Регламентные операции</span>
     <div class="opiration_button">
         <div class="opiration_button_left">
             <div class="now_calc font__14 user_select"><i class="fa fa-play" aria-hidden="true"></i>Выполнить
                 расчет</div>
         </div>
         <div class="button_main_rigt">
             <div class="button_main_items user_select font__14 ">Ещё</div>
             <div class="button_main_items user_select font__14 ">?</div>
         </div>
     </div>
     <div class="opiration_time_information">
         <div class="opiration_time_information_item">Текущий расчетный период: <span>01.03.2021</span>
         </div>
         <div class="opiration_time_information_item information_flex">
             <div class="flex_left"> <span>Информация о состоянии</span>
                 <div class="opiration_information">Карточки садоводов всего: 10, расчитанных: 10,
                     расчитанных пени: 10</div>
             </div>
             <div class="flex_right"></div><i class="fa fa-refresh" aria-hidden="true"></i>
         </div>
     </div>
     <div class="opiration_time_information_item">Вполнять расчет или очистку начислений только с
         карточками садоводов соответвующим отбору:</div>
     <form class="button_services">
         <div class="button_services_left">
             <div class="button_main_items user_select font__14 ">Создать</div>
             <div class="button_main_items user_select font__14 ">Сгрупперовать условия</div>
             <button class="button_main_items user_select font__14 " disabled="disabled">Удалить</button>
             <div class="button_arrow">
                 <div class="button_main_items arrow_one"><i class="fa fa-arrow-up"
                         aria-hidden="true"></i></div>
                 <div class="button_main_items arrow_two"><i class="fa fa-arrow-down"
                         aria-hidden="true"></i></div>
             </div>
             <button class="button_main_items user_select font__14 " disabled="disabled">Свойства
                 элемента пользовательских настроек</button>
         </div>
         <div class="button_main_rigt">
             <div class="button_main_items user_select font__14 ">Ещё</div>
         </div>
     </form>
     <div class="gardeneer_catd_action_all">
         <div class="gardeneer_catd_action_grid_header grid_action">
             <div class="gardeneer_catd_action_grid_header_items user_select"></div>
             <div class="gardeneer_catd_action_grid_header_items user_select">Наименование</div>
             <div class="gardeneer_catd_action_grid_header_items user_select">Вид сравнения</div>
             <div class="gardeneer_catd_action_grid_header_items user_select">Значения</div>
         </div>
         <!--Убрать бордер ботем у .gardeneer_catd_action_grid_action_itm и добавить его .gardeneer_catd_action_grid_action_sub-->
         <div class="gardeneer_catd_action_grid_action grid_action">
             <div class="gardeneer_catd_action_grid_action_itm user_select"></div>
             <div class="gardeneer_catd_action_grid_action_itm user_select"><i class="fa fa-minus-circle"
                     aria-hidden="true"></i></i><span>Обзор</span></div>
             <div class="gardeneer_catd_action_grid_action_itm user_select"></div>
             <div class="gardeneer_catd_action_grid_action_itm user_select"></div>
         </div>
         <div class="gardeneer_catd_action_grid_action_sub grid_action">
             <div class="gardeneer_catd_action_grid_action_itm  user_select none_style"><input
                     type="checkbox"></div>
             <div class="gardeneer_catd_action_grid_action_itm sub font__14 user_select">
                 <div class="minus"><i class="fa fa-minus" aria-hidden="true"></i></div>Холодное
                 водоснобжение по показаниям приборов учета
             </div>
             <div class="gardeneer_catd_action_grid_action_itm user_select">Равно</div>
             <div class="gardeneer_catd_action_grid_action_itm user_select"></div>
         </div>
     </div>
 </div>
 <div class="footer_button user_select">
     <div class="now_calc font__14"><i class="fa fa-play" aria-hidden="true"></i>Сменить расчетный период
     </div>
     <div class="opiration_time_information_item">Дата начада установки периода: <input type="date">  
     </div>
     <div class="footer_button_food user_select"><a href="#">Отключить контроль расчетного периода при записи документов можно в настройках параметра учета.</a></div>
 </div>',
     '<div class="re_culc">
     <span class="name_servises_itm font__25 ">Карточки садоводов</span>
     <form class="button_services">
         <div class="button_services_left user_select">
             <div class="button_main_items user_select font__14">Создать</div>
             <button class="button_main_items user_select font__14" disabled="true"><i class="fa fa-file-o" aria-hidden="true"></i></button>
             <div class="button_main_items user_select font__14 ">Найти..</div>
             <button class="button_main_items user_select font__14 " disabled="disabled">Отменить поиск</button>
             <div class="button_main_items user_select font__14 "><i class="fa fa-sort-alpha-asc"
                     aria-hidden="true"></i></div>
         </div>
         <div class="button_main_rigt">
             <div class="button_main_items user_select font__14 ">Ещё</div>
             <div class="button_main_items user_select font__14 ">?</div>
         </div>
     </form>
     <div class="gardeneer_catd_action_all">
         <div class="gardeneer_catd_action_grid_header">
             <div class="gardeneer_catd_action_grid_header_items  user_select">Дата</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Номер</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Cумма зачислений</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Ответственный</div>
             <div class="gardeneer_catd_action_grid_header_items  user_select">Комментарий</div>
         </div>
         <div class="gardeneer_catd_action_grid_action">
         </div>
     </div>
 </div>',
 '<div class="opiration">
     <span class="name_servises_itm font__25 ">Формирование печатных форм карточек садоводов</span>
     <div class="opiration_button">
         <div class="opiration_button_left">
             <div class="now_calc font__14 user_select"><i class="fa fa-play"
                     aria-hidden="true"></i>Сформировать</div>
         </div>
         <div class="button_main_rigt">
             <div class="button_main_items user_select font__14 ">Ещё</div>
             <div class="button_main_items user_select font__14 ">?</div>
         </div>
     </div>
 </div>
 <div class="all_parametrs">
     <div class="parametrs_item"><span class="font__14 user_select">Параметры формирования</span></div>
     <div class="parametrs">
         <form action="" class="parametrs_form">
             <div class="parametrs_form_item user_select">
                 <div class="parametrs_form_item_top font__14 ">
                     <span class="font__14">Период</span><input type="date"><span
                         class="font__14">Колличество л/с в пакете</span><input type="text">
                     <div class="close_input"><i class="fa fa-times" aria-hidden="true"></i></div>
                 </div>
                 <div class="parametrs_form_item_bottom font__14">
                     <span class="font__14">Режим формирования</span><input type="text">
                     <div class="next"><i class="fa fa-arrow-down" aria-hidden="true"></i></div>
                 </div>
             </div>
             <div class="gardeneer_catd_top">
                 <div class="gardeneer_catd_action_all">
                     <div class="gardeneer_catd_action_grid_header grid_action">
                         <div class="gardeneer_catd_action_grid_header_items user_select"></div>
                         <div class="gardeneer_catd_action_grid_header_items user_select">Наименование
                         </div>
                     </div>
                 </div>
                 <div class="gardeneer_catd_action_grid_action grid_action">
                     <div class="gardeneer_catd_action_grid_action_itm  user_select none_style"><input
                             type="checkbox"></div>
                     <div class="gardeneer_catd_action_grid_action_itm user_select"><span>Извещение
                             счет-квитанция</span></div>
                     <div class="gardeneer_catd_action_grid_action_itm  user_select none_style"><input
                             type="checkbox"></div>
                     <div class="gardeneer_catd_action_grid_action_itm user_select"><span>Извещение
                             счет Приказу 43 п/р</span></div>
                     <div class="gardeneer_catd_action_grid_action_itm  user_select none_style"><input
                             type="checkbox"></div>
                     <div class="gardeneer_catd_action_grid_action_itm user_select"><span>Извещение
                             счет Приказу 454</span></div>
                 </div>
             </div>
             <div class="gardeneer_catd_bottom">
                 <div class="sortiration_order">
                     <span class="active_item_form">Отбор</span>
                     <span class="sortiration_order_item">порядок</span>
                 </div>
                 <div class="button_services_container">
                 </div>
             </div>
     </div>
     </form>
 </div>'
 ];
 function gardeeneers_render($link){
    $gardeneer_card_list = '
        SELECT gardener_cards.FIO_gardener,plot_information.plot_number,plot_information.plot_square,history_settlement.initial_balance,history_settlement.accruals, history_settlement.payment,history_settlement.final_balance 
        FROM gardener_cards 
        LEFT JOIN plot_information ON plot_information.id_plot = gardener_cards.id_plot 
        LEFT JOIN history_settlement ON history_settlement.id_gardener = gardener_cards.id_gardener
    ';
    $result_gardeneer = mysqli_query($link,$gardeneer_card_list) or die(mysqli_error($link));
    for($gardeneer_items=[]; $row=mysqli_fetch_assoc($result_gardeneer); $gardeneer_items[]=$row);
    $result = '';
    foreach($gardeneer_items as $elem){
        $result .= '
            <div class="gardeneer_catd_action_grid_action">
                <div class="gardeneer_catd_action_grid_action_itm font__14 user_select">'.$elem['FIO_gardener'].'</div>
                <div class="gardeneer_catd_action_grid_action_itm font__14 user_select">'.$elem['plot_number'].'</div>
                <div class="gardeneer_catd_action_grid_action_itm font__14 user_select">'.$elem['plot_square'].'</div>
                <div class="gardeneer_catd_action_grid_action_itm font__14 user_select">'.$elem['initial_balance'].'</div>
                <div class="gardeneer_catd_action_grid_action_itm font__14 user_select">'.$elem['accruals'].'</div>
                <div class="gardeneer_catd_action_grid_action_itm font__14 user_select">'.$elem['payment'].'</div>
                <div class="gardeneer_catd_action_grid_action_itm font__14 user_select">'.$elem['final_balance'].'</div>
            </div>
        ';
    }
    return $result;
}
?>
<div class="form_table">
    <?php 
        $db_gardeneers_items = gardeeneers_render($link) ;
        $sub_search = '<div class="gardeneer_action_wrapper">';
        if(!empty($_GET['gardeneers_button_number'])){
            echo $gardeneers_buttons[$_GET['gardeneers_button_number']];
        }else{
            $temp_result = strripos($gardeneers_buttons[0],$sub_search);
            $gardeneers_buttons[0] = substr_replace($gardeneers_buttons[0],$db_gardeneers_items,strlen($sub_search)+$temp_result,0);
            echo $gardeneers_buttons[0];
        }
    ?>
</div>